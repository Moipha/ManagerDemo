"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[236],{445:function(t,e,a){a.r(e),a.d(e,{default:function(){return d}});a(7658);var i=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"margin-top":"60px","overflow-y":"scroll"}},[e("h2",{staticStyle:{margin:"-60px auto 0",width:"200px"}},[t._v("添加养老院信息")]),e("el-form",{ref:"form",staticStyle:{"margin-top":"50px"},attrs:{model:t.home,"label-width":"150px","label-position":"left"}},[e("el-form-item",{attrs:{label:"养老院名称"}},[e("el-input",{staticStyle:{width:"40%"},attrs:{"prefix-icon":"el-icon-office-building",clearable:"",maxlength:"32","show-word-limit":""},model:{value:t.home.name,callback:function(e){t.$set(t.home,"name",e)},expression:"home.name"}})],1),e("el-form-item",{attrs:{label:"养老院简介"}},[e("el-input",{staticStyle:{width:"80%"},attrs:{type:"textarea",clearable:"",rows:3},model:{value:t.home.description,callback:function(e){t.$set(t.home,"description",e)},expression:"home.description"}})],1),e("el-form-item",{attrs:{label:"养老院地址"}},[e("el-input",{staticStyle:{width:"60%"},attrs:{"prefix-icon":"el-icon-location-outline",clearable:""},model:{value:t.home.address,callback:function(e){t.$set(t.home,"address",e)},expression:"home.address"}})],1),e("el-form-item",{attrs:{label:"创建时间"}},[e("el-date-picker",{attrs:{type:"date",format:"yyyy 年 MM 月 dd 日"},model:{value:t.home.createTime,callback:function(e){t.$set(t.home,"createTime",e)},expression:"home.createTime"}})],1),e("el-form-item",{attrs:{label:"展示图片"}},[e("el-upload",{ref:"avatar1",staticClass:"avatar-uploader",staticStyle:{"margin-top":"10px"},attrs:{limit:1,"show-file-list":!1,"on-change":e=>t.uploadChange(e,!0),action:"https://"+t.serverIp+"/details/upload","auto-upload":!1,"list-type":"picture","on-success":t.handleUpload1}},[t.upload1?e("img",{staticClass:"avatar",attrs:{src:t.upload1,alt:""}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e("el-form-item",{attrs:{label:"荣誉图"}},[e("el-upload",{ref:"avatar2",staticClass:"avatar-uploader",staticStyle:{"margin-top":"10px"},attrs:{limit:1,"show-file-list":!1,"on-change":e=>t.uploadChange(e,!1),action:"https://"+t.serverIp+"/details/upload","auto-upload":!1,"list-type":"picture","on-success":t.handleUpload2}},[t.upload2?e("img",{staticClass:"avatar",attrs:{src:t.upload2,alt:""}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e("el-form-item",{attrs:{label:"联系人信息"}},[t.home.contactsId?e("el-card",{staticClass:"box-card card",attrs:{shadow:"hover"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("联系人："+t._s(t.contact.name))]),e("span",{staticStyle:{"margin-left":"10px"}},[t._v("性别："+t._s(t.contact.sex))]),e("el-button",{staticStyle:{float:"right","margin-left":"5px"},attrs:{size:"medium",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.deleteCard(!0)}}}),e("el-button",{staticStyle:{float:"right"},attrs:{size:"medium",type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(e){return t.editCard(!0)}}})],1),t.contact.qqNumber?e("el-row",[e("el-col",{attrs:{span:7}},[t._v("QQ账号：")]),e("el-col",{attrs:{span:17}},[t._v(t._s(t.contact.qqNumber))])],1):t._e(),t.contact.qqEmail?e("el-row",[e("el-col",{attrs:{span:7}},[t._v("邮箱：")]),e("el-col",{attrs:{span:17}},[t._v(t._s(t.contact.qqEmail))])],1):t._e(),t.contact.phoneUmber?e("el-row",[e("el-col",{attrs:{span:7}},[t._v("电话号码：")]),e("el-col",{attrs:{span:17}},[t._v(t._s(t.contact.phoneUmber))])],1):t._e(),t.contact.wechatId?e("el-row",[e("el-col",{attrs:{span:7}},[t._v("微信账号：")]),e("el-col",{attrs:{span:17}},[t._v(t._s(t.contact.wechatId))])],1):t._e(),t.contact.weiboId?e("el-row",[e("el-col",{attrs:{span:7}},[t._v("微博账号：")]),e("el-col",{attrs:{span:17}},[t._v(t._s(t.contact.weiboId))])],1):t._e(),t.contact.wechatOfficialAccounts?e("el-row",[e("el-col",{attrs:{span:7}},[t._v("微信公众号：")]),e("el-col",{attrs:{span:17}},[t._v(t._s(t.contact.wechatOfficialAccounts))])],1):t._e(),t.contact.contactOnline?e("el-row",[e("el-col",{attrs:{span:7}},[t._v("在线热线：")]),e("el-col",{attrs:{span:17}},[t._v(t._s(t.contact.contactOnline))])],1):t._e()],1):e("el-button",{staticClass:"btn",attrs:{icon:"el-icon-user"},on:{click:function(e){return t.openDialog(!0)}}},[t._v("添加联系人信息")])],1),e("el-form-item",{attrs:{label:"养老院价格信息"}},[t.home.priceDetails?e("el-card",{staticClass:"box-card card",attrs:{shadow:"hover"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("总费用："+t._s(t.totalCost))]),e("el-button",{staticStyle:{float:"right","margin-left":"5px"},attrs:{size:"medium",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.deleteCard(!1)}}}),e("el-button",{staticStyle:{float:"right"},attrs:{size:"medium",type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(e){return t.editCard(!1)}}})],1),t.price.bedFee?e("el-row",[e("el-col",{attrs:{span:7}},[t._v("床位费用：")]),e("el-col",{attrs:{span:17}},[t._v(t._s(t.price.bedFee))])],1):t._e(),t.price.nursingFee?e("el-row",[e("el-col",{attrs:{span:7}},[t._v("护理费用：")]),e("el-col",{attrs:{span:17}},[t._v(t._s(t.price.nursingFee))])],1):t._e(),t.price.foodFee?e("el-row",[e("el-col",{attrs:{span:7}},[t._v("餐饮费：")]),e("el-col",{attrs:{span:17}},[t._v(t._s(t.price.foodFee))])],1):t._e(),t.price.otherFee?e("el-row",[e("el-col",{attrs:{span:7}},[t._v("其他费用：")]),e("el-col",{attrs:{span:17}},[t._v(t._s(t.price.otherFee))])],1):t._e()],1):e("el-button",{staticClass:"btn",attrs:{icon:"el-icon-coin"},on:{click:function(e){return t.openDialog(!1)}}},[t._v("添加养老院价格信息")])],1),e("el-form-item",{attrs:{label:"特色服务"}},[e("el-input",{staticStyle:{width:"40%"},attrs:{type:"textarea",clearable:"",rows:3},model:{value:t.home.specialServices,callback:function(e){t.$set(t.home,"specialServices",e)},expression:"home.specialServices"}})],1),e("el-form-item",{staticStyle:{"margin-top":"50px"}},[e("el-button",{staticClass:"btn",attrs:{icon:"el-icon-finished"},on:{click:t.addCareHome}},[t._v("保存并添加")]),e("el-button",{staticClass:"btnWithoutColor",attrs:{type:"warning",icon:"el-icon-delete"},on:{click:t.clear}},[t._v("清空表单")]),e("el-button",{staticClass:"btnWithoutColor danger",attrs:{type:"danger",icon:"el-icon-back"},on:{click:function(e){return t.$router.push("/care-home")}}},[t._v("返回 ")])],1),e("el-dialog",{attrs:{visible:t.dialog1,"show-close":!1,limit:1,"modal-append-to-body":!1,"append-to-body":!1},on:{"update:visible":function(e){t.dialog1=e},close:function(e){return t.closeDialog(!0)}}},[e("h2",{staticStyle:{color:"var(--deepText)","padding-top":"20px"},attrs:{align:"center"}},[t._v(t._s(t.btnWord)+"联系人信息")]),e("el-divider"),e("div",{staticStyle:{margin:"5% 10% 3%",padding:"3% 5% 1%"}},[e("el-form",{attrs:{model:t.contact,"label-width":"100px","label-position":"left"}},[e("el-form-item",{staticStyle:{"margin-top":"-30px"},attrs:{label:"联系人姓名"}},[e("el-input",{staticStyle:{width:"70%"},attrs:{clearable:"",maxlength:"10","show-word-limit":""},model:{value:t.contact.name,callback:function(e){t.$set(t.contact,"name",e)},expression:"contact.name"}})],1),e("el-form-item",{attrs:{label:"性别"}},[e("el-radio-group",{model:{value:t.contact.sex,callback:function(e){t.$set(t.contact,"sex",e)},expression:"contact.sex"}},[e("el-radio-button",{staticStyle:{"margin-right":"1px"},attrs:{label:"男"}}),e("el-radio-button",{attrs:{label:"女"}})],1)],1),e("el-form-item",{attrs:{label:"QQ账号"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",maxlength:"32","show-word-limit":""},model:{value:t.contact.qqNumber,callback:function(e){t.$set(t.contact,"qqNumber",e)},expression:"contact.qqNumber"}})],1),e("el-form-item",{attrs:{label:"QQ邮箱"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",maxlength:"32","show-word-limit":""},model:{value:t.contact.qqEmail,callback:function(e){t.$set(t.contact,"qqEmail",e)},expression:"contact.qqEmail"}})],1),e("el-form-item",{attrs:{label:"联系电话"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",maxlength:"32","show-word-limit":""},model:{value:t.contact.phoneUmber,callback:function(e){t.$set(t.contact,"phoneUmber",e)},expression:"contact.phoneUmber"}})],1),e("el-form-item",{attrs:{label:"微信账号"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",maxlength:"32","show-word-limit":""},model:{value:t.contact.wechatId,callback:function(e){t.$set(t.contact,"wechatId",e)},expression:"contact.wechatId"}})],1),e("el-form-item",{attrs:{label:"微博账号"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",maxlength:"32","show-word-limit":""},model:{value:t.contact.weiboId,callback:function(e){t.$set(t.contact,"weiboId",e)},expression:"contact.weiboId"}})],1),e("el-form-item",{attrs:{label:"微信公众号"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",maxlength:"32","show-word-limit":""},model:{value:t.contact.wechatOfficialAccounts,callback:function(e){t.$set(t.contact,"wechatOfficialAccounts",e)},expression:"contact.wechatOfficialAccounts"}})],1),e("el-form-item",{staticStyle:{"margin-bottom":"5px"},attrs:{label:"养老院热线"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",maxlength:"32","show-word-limit":""},model:{value:t.contact.contactOnline,callback:function(e){t.$set(t.contact,"contactOnline",e)},expression:"contact.contactOnline"}})],1)],1)],1),e("el-divider"),e("div",{staticStyle:{display:"flex","flex-direction":"row"}},[e("el-button",{staticClass:"formBtn",on:{click:t.addContact}},[t._v(t._s(t.btnWord))]),e("el-button",{staticClass:"formBtn",on:{click:function(e){return t.closeDialog(!0)}}},[t._v("取消")])],1)],1),e("el-dialog",{attrs:{visible:t.dialog2,"show-close":!1,limit:1,"modal-append-to-body":!1,"append-to-body":!1},on:{"update:visible":function(e){t.dialog2=e},close:function(e){return t.closeDialog(!1)}}},[e("h2",{staticStyle:{color:"var(--deepText)","padding-top":"20px"},attrs:{align:"center"}},[t._v(t._s(t.btnWord)+"价格信息")]),e("el-divider"),e("div",{staticStyle:{margin:"5% 10% 3%",padding:"3% 5% 1%"}},[e("el-form",{staticStyle:{"margin-bottom":"70px"},attrs:{model:t.price,"label-width":"150px","label-position":"left"}},[e("el-form-item",{attrs:{label:"养老院名称"}},[e("span",[t._v(t._s(t.home.name))])]),e("el-form-item",{staticStyle:{"margin-top":"30px"},attrs:{label:"总费用"}},[e("span",{staticStyle:{color:"var(--lightText)"}},[t._v(t._s(t.totalCost))])]),e("el-form-item",{staticStyle:{"margin-top":"30px"},attrs:{label:"床位费用 (月)"}},[e("el-input-number",{staticStyle:{width:"150px"},attrs:{min:0,step:100},model:{value:t.price.bedFee,callback:function(e){t.$set(t.price,"bedFee",e)},expression:"price.bedFee"}})],1),e("el-form-item",{staticStyle:{"margin-top":"30px"},attrs:{label:"护理费用 (月)"}},[e("el-input-number",{staticStyle:{width:"150px"},attrs:{min:0,step:100},model:{value:t.price.nursingFee,callback:function(e){t.$set(t.price,"nursingFee",e)},expression:"price.nursingFee"}})],1),e("el-form-item",{staticStyle:{"margin-top":"30px"},attrs:{label:"餐饮费用 (月)"}},[e("el-input-number",{staticStyle:{width:"150px"},attrs:{min:0,step:100},model:{value:t.price.foodFee,callback:function(e){t.$set(t.price,"foodFee",e)},expression:"price.foodFee"}})],1),e("el-form-item",{staticStyle:{"margin-top":"30px"},attrs:{label:"其他费用 (月)"}},[e("el-input-number",{staticStyle:{width:"150px"},attrs:{min:0,step:100},model:{value:t.price.otherFee,callback:function(e){t.$set(t.price,"otherFee",e)},expression:"price.otherFee"}})],1)],1)],1),e("el-divider"),e("div",{staticStyle:{display:"flex","flex-direction":"row"}},[e("el-button",{staticClass:"formBtn",on:{click:t.addPrice}},[t._v(t._s(t.btnWord))]),e("el-button",{staticClass:"formBtn",on:{click:function(e){return t.closeDialog(!0)}}},[t._v("取消")])],1)],1)],1)],1)},l=[],o=a(2618),s={name:"CareHomeData",data(){return{home:{},contact:{},price:{},mode:"add",serverIp:o.I,upload1:"",upload2:"",dialog1:!1,dialog2:!1,btnWord:"添加"}},computed:{totalCost(){let t=this.price.bedFee?this.price.bedFee:0,e=this.price.nursingFee?this.price.nursingFee:0,a=this.price.foodFee?this.price.foodFee:0,i=this.price.otherFee?this.price.otherFee:0;return t+e+a+i+" 元/月"}},methods:{uploadChange(t,e){const a=new FileReader;a.readAsDataURL(t.raw),a.onload=()=>{e?this.upload1=a.result:this.upload2=a.result}},handleUpload1(t){"200"!==t.code?this.$notify({title:"展示图片上传失败",message:t.msg,type:"error"}):this.home.imageGallery=t.msg},handleUpload2(t){"200"!==t.code?this.$notify({title:"荣誉图上传失败",message:t.msg,type:"error"}):this.home.honors=t.msg},clear(){this.home={},this.price={},this.contact={},this.upload1="",this.upload2=""},openDialog(t){t?this.dialog1=!0:this.dialog2=!0,this.btnWord="添加"},closeDialog(t){"添加"===this.btnWord&&(t?this.home.contactsId||(this.contact={}):this.home.priceDetails||(this.price={})),this.dialog1=!1,this.dialog2=!1},addPrice(){this.home.priceDetails||(this.home.priceDetails="1"),this.dialog2=!1},addContact(){this.home.contactsId||(this.home.contactsId="1"),this.dialog1=!1},editCard(t){t?this.dialog1=!0:this.dialog2=!0,this.btnWord="修改"},deleteCard(t){t?(this.home.contactsId=null,this.contact={}):(this.home.priceDetails=null,this.price={})},addCareHome(){""!==this.upload1&&this.$refs.avatar1.submit(),""!==this.upload2&&this.$refs.avatar2.submit(),this.request.post("/details/add",this.home).then((t=>{"200"===t.code?(this.$notify({type:"success",title:"保存成功",message:"养老院信息已保存"}),this.contact.contactId=t.msg,this.price.careHomeId=t.msg,this.home.id=t.msg,this.submitContactAndPrice()):this.$notify({type:"error",title:"养老院信息保存失败",message:t.msg})})).catch((t=>{this.$notify({type:"error",title:"养老院信息保存失败",message:t})}))},updateDetails(){this.request.put("/details/edit",this.home).then((t=>{"200"!==t.code?this.$notify({type:"error",title:"养老院信息更新失败",message:t.msg}):(this.clear(),this.$router.push("/care-home"))})).catch((t=>{this.$notify({type:"error",title:"养老院信息更新失败",message:t})}))},submitContactAndPrice(){this.request.post("/contacts/add",this.contact).then((t=>{"200"!==t.code?this.$notify({type:"error",title:"联系人信息保存失败",message:t.msg}):(this.home.contactsId=t.msg,this.request.post("/price-details/add",this.price).then((t=>{"200"!==t.code?this.$notify({type:"error",title:"价格信息保存失败",message:t.msg}):(this.home.priceDetails=t.msg,this.updateDetails())})).catch((t=>{this.$notify({type:"error",title:"价格信息保存失败",message:t})})))})).catch((t=>{this.$notify({type:"error",title:"联系人信息保存失败",message:t})}))}},mounted(){this.mode=this.$route.query.mode}},c=s,r=a(1001),n=(0,r.Z)(c,i,l,!1,null,"933d9d48",null),d=n.exports}}]);
//# sourceMappingURL=236.23664f2d.js.map